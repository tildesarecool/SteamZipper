[
  {
    "TestName": "CreateAnswerFile",
    "Command": "& { .\\steamzipper.ps1 -sourceFolder 'P:\\steamzipper\\steam temp storage' -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest -createAnswerFile:answer.txt }",
    "Status": "Fail",
    "Details": [
      "Zip count matches: 14",
      "Answer file created",
      "zip decision table count matches: 9",
      "Expected 14 initialization entries, got 11",
      "compress table count matches: 8",
      "first refined table count matches: 9"
    ],
    "Transcript": "**********************\r\nPowerShell transcript start\r\nStart time: 20250311142934\r\nUsername: GALACTICA\\Keith\r\nRunAs User: GALACTICA\\Keith\r\nConfiguration Name: \r\nMachine: GALACTICA (Microsoft Windows NT 10.0.19045.0)\r\nHost Application: C:\\Program Files\\PowerShell\\7\\pwsh.dll -Command & { .\\steamzipper.ps1 -sourceFolder 'P:\\steamzipper\\steam temp storage' -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest -createAnswerFile:answer.txt } -NonInteractive -ErrorAction Stop\r\nProcess ID: 834348\r\nPSVersion: 7.5.0\r\nPSEdition: Core\r\nGitCommitId: 7.5.0\r\nOS: Microsoft Windows 10.0.19045\r\nPlatform: Win32NT\r\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0\r\nPSRemotingProtocolVersion: 2.3\r\nSerializationVersion: 1.1.0.1\r\nWSManStackVersion: 3.0\r\n**********************\r\nCreated answer file: answer.txt\r\nBuilt initialization table with 11 entries\r\nChecking bit Dungeon: Size 44457.5537109375 KB\r\nChecking bit Dungeon II: Size 72976.064453125 KB\r\nChecking bit Dungeon III: Size 343405.794921875 KB\r\nChecking cyberpunk: Size 0 KB\r\nSkipping empty subfolder: cyberpunk (Size: 0 KB)\r\nChecking Dig Dog: Size 107282.669921875 KB\r\nChecking doom 2016: Size 0 KB\r\nSkipping empty subfolder: doom 2016 (Size: 0 KB)\r\nChecking Horizon Chase: Size 1282925.18847656 KB\r\nChecking Markov Alg: Size 6295.462890625 KB\r\nChecking Ms. PAC-MAN: Size 813127.333984375 KB\r\nChecking Outzone: Size 3657.0087890625 KB\r\nChecking PAC-MAN: Size 800904.712890625 KB\r\nBuilt first refined table with 9 entries\r\nSubfolder bit Dungeon has no existing zip, marked as NeedsZip\r\nSubfolder bit Dungeon II has no existing zip, marked as NeedsZip\r\nSubfolder bit Dungeon III has no existing zip, marked as NeedsZip\r\nSubfolder Dig Dog zip (Dig_Dog_11012024_steam.zip) is older than folder, marked as NeedsUpdate\r\nSubfolder Horizon Chase zip (Horizon_Chase_12152024_steam.zip) is older than folder, marked as NeedsUpdate\r\nSubfolder Markov Alg zip (Markov_Alg_12012024_steam.zip) is current or newer, marked as NoAction\r\nSubfolder Ms. PAC-MAN has no existing zip, marked as NeedsZip\r\nSubfolder Outzone has no existing zip, marked as NeedsZip\r\nSubfolder PAC-MAN zip (PAC-MAN_01012025_steam.zip) is older than folder, marked as NeedsUpdate\r\nBuilt zip decision table with 9 entries\r\nBuilt compress table with 8 entries\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Dig_Dog_11092024_steam.zip (0 KB)\r\nStub created for Dig Dog\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Horizon_Chase_01012025_steam.zip (0 KB)\r\nStub created for Horizon Chase\r\nCreated stub zip: P:\\steamzipper\\zip test output\\PAC-MAN_02062025_steam.zip (0 KB)\r\nStub created for PAC-MAN\r\nCreated stub zip: P:\\steamzipper\\zip test output\\bit_Dungeon_11012024_steam.zip (0 KB)\r\nStub created for bit Dungeon\r\nCreated stub zip: P:\\steamzipper\\zip test output\\bit_Dungeon_II_11012024_steam.zip (0 KB)\r\nStub created for bit Dungeon II\r\nCreated stub zip: P:\\steamzipper\\zip test output\\bit_Dungeon_III_11012024_steam.zip (0 KB)\r\nStub created for bit Dungeon III\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Ms._PAC-MAN_11012024_steam.zip (0 KB)\r\nStub created for Ms. PAC-MAN\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Outzone_11012024_steam.zip (0 KB)\r\nStub created for Outzone\r\n**********************\r\nPowerShell transcript end\r\nEnd time: 20250311142934\r\n**********************\r\n"
  },
  {
    "TestName": "BasicRun",
    "Command": "& { .\\steamzipper.ps1 -sourceFolder 'P:\\steamzipper\\steam temp storage' -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest }",
    "Status": "Fail",
    "Details": [
      "Zip count matches: 14",
      "zip decision table count matches: 9",
      "Expected 14 initialization entries, got 11",
      "compress table count matches: 8",
      "first refined table count matches: 9"
    ],
    "Transcript": "**********************\r\nPowerShell transcript start\r\nStart time: 20250311142935\r\nUsername: GALACTICA\\Keith\r\nRunAs User: GALACTICA\\Keith\r\nConfiguration Name: \r\nMachine: GALACTICA (Microsoft Windows NT 10.0.19045.0)\r\nHost Application: C:\\Program Files\\PowerShell\\7\\pwsh.dll -Command & { .\\steamzipper.ps1 -sourceFolder 'P:\\steamzipper\\steam temp storage' -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest } -NonInteractive -ErrorAction Stop\r\nProcess ID: 913452\r\nPSVersion: 7.5.0\r\nPSEdition: Core\r\nGitCommitId: 7.5.0\r\nOS: Microsoft Windows 10.0.19045\r\nPlatform: Win32NT\r\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0\r\nPSRemotingProtocolVersion: 2.3\r\nSerializationVersion: 1.1.0.1\r\nWSManStackVersion: 3.0\r\n**********************\r\nBuilt initialization table with 11 entries\r\nChecking bit Dungeon: Size 44457.5537109375 KB\r\nChecking bit Dungeon II: Size 72976.064453125 KB\r\nChecking bit Dungeon III: Size 343405.794921875 KB\r\nChecking cyberpunk: Size 0 KB\r\nSkipping empty subfolder: cyberpunk (Size: 0 KB)\r\nChecking Dig Dog: Size 107282.669921875 KB\r\nChecking doom 2016: Size 0 KB\r\nSkipping empty subfolder: doom 2016 (Size: 0 KB)\r\nChecking Horizon Chase: Size 1282925.18847656 KB\r\nChecking Markov Alg: Size 6295.462890625 KB\r\nChecking Ms. PAC-MAN: Size 813127.333984375 KB\r\nChecking Outzone: Size 3657.0087890625 KB\r\nChecking PAC-MAN: Size 800904.712890625 KB\r\nBuilt first refined table with 9 entries\r\nSubfolder bit Dungeon has no existing zip, marked as NeedsZip\r\nSubfolder bit Dungeon II has no existing zip, marked as NeedsZip\r\nSubfolder bit Dungeon III has no existing zip, marked as NeedsZip\r\nSubfolder Dig Dog zip (Dig_Dog_11012024_steam.zip) is older than folder, marked as NeedsUpdate\r\nSubfolder Horizon Chase zip (Horizon_Chase_12152024_steam.zip) is older than folder, marked as NeedsUpdate\r\nSubfolder Markov Alg zip (Markov_Alg_12012024_steam.zip) is current or newer, marked as NoAction\r\nSubfolder Ms. PAC-MAN has no existing zip, marked as NeedsZip\r\nSubfolder Outzone has no existing zip, marked as NeedsZip\r\nSubfolder PAC-MAN zip (PAC-MAN_01012025_steam.zip) is older than folder, marked as NeedsUpdate\r\nBuilt zip decision table with 9 entries\r\nBuilt compress table with 8 entries\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Dig_Dog_11092024_steam.zip (0 KB)\r\nStub created for Dig Dog\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Horizon_Chase_01012025_steam.zip (0 KB)\r\nStub created for Horizon Chase\r\nCreated stub zip: P:\\steamzipper\\zip test output\\PAC-MAN_02062025_steam.zip (0 KB)\r\nStub created for PAC-MAN\r\nCreated stub zip: P:\\steamzipper\\zip test output\\bit_Dungeon_11012024_steam.zip (0 KB)\r\nStub created for bit Dungeon\r\nCreated stub zip: P:\\steamzipper\\zip test output\\bit_Dungeon_II_11012024_steam.zip (0 KB)\r\nStub created for bit Dungeon II\r\nCreated stub zip: P:\\steamzipper\\zip test output\\bit_Dungeon_III_11012024_steam.zip (0 KB)\r\nStub created for bit Dungeon III\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Ms._PAC-MAN_11012024_steam.zip (0 KB)\r\nStub created for Ms. PAC-MAN\r\nCreated stub zip: P:\\steamzipper\\zip test output\\Outzone_11012024_steam.zip (0 KB)\r\nStub created for Outzone\r\n**********************\r\nPowerShell transcript end\r\nEnd time: 20250311142935\r\n**********************\r\n"
  },
  {
    "TestName": "ConflictingParams",
    "Command": "& { .\\steamzipper.ps1 -sourceFolder 'P:\\steamzipper\\steam temp storage' -destinationFolder 'P:\\steamzipper\\zip test output' -answerFile:answer.txt }",
    "Status": "Pass",
    "Details": [
      "Zip count check skipped (expected)"
    ],
    "Transcript": "No transcript generated"
  },
  {
    "TestName": "MissingSourceFolder",
    "Command": "& { .\\steamzipper.ps1 -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest }",
    "Status": "Fail",
    "Details": "Exception: Command failed with exit code 0: Welcome to SteamZipper! This script zips your Steam folders. Ensure the storage device of 'P:\\steamzipper\\zip test output' has enough space! Running on GALACTICA - 03/11/2025 14:29:52 \u001b[31;1mmain: \u001b[0mC:\\Users\\Keith\\Documents\\repos\\SteamZipper\\steamzipper.ps1:394\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1mLine |\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1m\u001b[36;1m 394 | \u001b[0m try { \u001b[36;1mmain\u001b[0m } catch { Write-Error \"Script failed: $($_.Exception.Messa .\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1m\u001b[36;1m\u001b[0m\u001b[36;1m\u001b[0m\u001b[36;1m     | \u001b[31;1m       ~~~~\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1m\u001b[36;1m\u001b[0m\u001b[36;1m\u001b[0m\u001b[36;1m\u001b[31;1m\u001b[31;1m\u001b[36;1m     | \u001b[31;1mError: Source folder '\"P:\\steamzipper\\steam temp storage\"' not found or invalid, exiting...\u001b[0m",
    "Transcript": "**********************\r\nPowerShell transcript start\r\nStart time: 20250311142952\r\nUsername: GALACTICA\\Keith\r\nRunAs User: GALACTICA\\Keith\r\nConfiguration Name: \r\nMachine: GALACTICA (Microsoft Windows NT 10.0.19045.0)\r\nHost Application: C:\\Program Files\\PowerShell\\7\\pwsh.dll -Command & { .\\steamzipper.ps1 -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest } -NonInteractive -ErrorAction Stop\r\nProcess ID: 879864\r\nPSVersion: 7.5.0\r\nPSEdition: Core\r\nGitCommitId: 7.5.0\r\nOS: Microsoft Windows 10.0.19045\r\nPlatform: Win32NT\r\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0\r\nPSRemotingProtocolVersion: 2.3\r\nSerializationVersion: 1.1.0.1\r\nWSManStackVersion: 3.0\r\n**********************\r\nPS>TerminatingError(): \"Error: Source folder '\"P:\\steamzipper\\steam temp storage\"' not found or invalid, exiting...\"\r\nmain: C:\\Users\\Keith\\Documents\\repos\\SteamZipper\\steamzipper.ps1:394\r\nLine |\r\n 394 |  try { main } catch { Write-Error \"Script failed: $($_.Exception.Messa …\r\n     |        ~~~~\r\n     | Error: Source folder '\"P:\\steamzipper\\steam temp storage\"' not found or invalid, exiting...\r\nmain: C:\\Users\\Keith\\Documents\\repos\\SteamZipper\\steamzipper.ps1:394\r\nLine |\r\n 394 |  try { main } catch { Write-Error \"Script failed: $($_.Exception.Messa …\r\n     |        ~~~~\r\n     | Error: Source folder '\"P:\\steamzipper\\steam temp storage\"' not found or invalid, exiting...\r\n\r\n**********************\r\nPowerShell transcript end\r\nEnd time: 20250311142952\r\n**********************\r\n"
  },
  {
    "TestName": "InvalidSourceFolder",
    "Command": "& { .\\steamzipper.ps1 -sourceFolder 'P:\\nonexistent\\path' -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest }",
    "Status": "Fail",
    "Details": "Exception: Command failed with exit code 0: Welcome to SteamZipper! This script zips your Steam folders. Ensure the storage device of 'P:\\steamzipper\\zip test output' has enough space! Running on GALACTICA - 03/11/2025 14:29:53 \u001b[31;1mmain: \u001b[0mC:\\Users\\Keith\\Documents\\repos\\SteamZipper\\steamzipper.ps1:394\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1mLine |\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1m\u001b[36;1m 394 | \u001b[0m try { \u001b[36;1mmain\u001b[0m } catch { Write-Error \"Script failed: $($_.Exception.Messa .\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1m\u001b[36;1m\u001b[0m\u001b[36;1m\u001b[0m\u001b[36;1m     | \u001b[31;1m       ~~~~\u001b[0m \u001b[31;1m\u001b[0m\u001b[36;1m\u001b[36;1m\u001b[0m\u001b[36;1m\u001b[0m\u001b[36;1m\u001b[31;1m\u001b[31;1m\u001b[36;1m     | \u001b[31;1mError: Source folder 'P:\\nonexistent\\path' not found or invalid, exiting...\u001b[0m",
    "Transcript": "**********************\r\nPowerShell transcript start\r\nStart time: 20250311142953\r\nUsername: GALACTICA\\Keith\r\nRunAs User: GALACTICA\\Keith\r\nConfiguration Name: \r\nMachine: GALACTICA (Microsoft Windows NT 10.0.19045.0)\r\nHost Application: C:\\Program Files\\PowerShell\\7\\pwsh.dll -Command & { .\\steamzipper.ps1 -sourceFolder 'P:\\nonexistent\\path' -destinationFolder 'P:\\steamzipper\\zip test output' -debugMode -VerbMode -keepDuplicates -CompressionLevel Fastest } -NonInteractive -ErrorAction Stop\r\nProcess ID: 918124\r\nPSVersion: 7.5.0\r\nPSEdition: Core\r\nGitCommitId: 7.5.0\r\nOS: Microsoft Windows 10.0.19045\r\nPlatform: Win32NT\r\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0\r\nPSRemotingProtocolVersion: 2.3\r\nSerializationVersion: 1.1.0.1\r\nWSManStackVersion: 3.0\r\n**********************\r\nPS>TerminatingError(): \"Error: Source folder 'P:\\nonexistent\\path' not found or invalid, exiting...\"\r\nmain: C:\\Users\\Keith\\Documents\\repos\\SteamZipper\\steamzipper.ps1:394\r\nLine |\r\n 394 |  try { main } catch { Write-Error \"Script failed: $($_.Exception.Messa …\r\n     |        ~~~~\r\n     | Error: Source folder 'P:\\nonexistent\\path' not found or invalid, exiting...\r\nmain: C:\\Users\\Keith\\Documents\\repos\\SteamZipper\\steamzipper.ps1:394\r\nLine |\r\n 394 |  try { main } catch { Write-Error \"Script failed: $($_.Exception.Messa …\r\n     |        ~~~~\r\n     | Error: Source folder 'P:\\nonexistent\\path' not found or invalid, exiting...\r\n\r\n**********************\r\nPowerShell transcript end\r\nEnd time: 20250311142953\r\n**********************\r\n"
  }
]
